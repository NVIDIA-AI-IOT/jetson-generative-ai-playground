---
import Layout from '../layouts/Layout.astro';
import { getCollection } from 'astro:content';

const allProjects = await getCollection('projects');
// Sort by date (newest first)
allProjects.sort((a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime());

const sourceColors: Record<string, { bg: string; text: string }> = {
  'GitHub': { bg: 'bg-gray-800', text: 'text-white' },
  'Hackster': { bg: 'bg-orange-500', text: 'text-white' },
  'YouTube': { bg: 'bg-red-600', text: 'text-white' },
  'NVIDIA': { bg: 'bg-nvidia-green', text: 'text-nvidia-black' },
  'JetsonHacks': { bg: 'bg-blue-600', text: 'text-white' },
  'Medium': { bg: 'bg-gray-900', text: 'text-white' },
  'Seeed': { bg: 'bg-green-600', text: 'text-white' },
  'Other': { bg: 'bg-gray-500', text: 'text-white' },
};
---

<Layout title="Community Projects - Jetson AI Lab" description="Community projects showcasing generative AI implementations on the NVIDIA Jetson platform.">
  <!-- Hero Section -->
  <section class="relative bg-nvidia-black text-white py-24 overflow-hidden">
    <div class="absolute inset-0 overflow-hidden">
      <div class="absolute -top-40 -right-40 w-96 h-96 bg-nvidia-green/20 rounded-full blur-3xl"></div>
      <div class="absolute top-20 -left-20 w-72 h-72 bg-purple-500/10 rounded-full blur-3xl"></div>
    </div>
    
    <div class="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
      <h1 class="text-5xl md:text-6xl font-bold tracking-tight mb-6">
        <span class="bg-clip-text text-transparent bg-gradient-to-r from-nvidia-white to-nvidia-gray-300">
          Community Projects
        </span>
      </h1>
      <p class="text-xl text-nvidia-gray-300 max-w-2xl mx-auto leading-relaxed">
        Discover guides, tutorials, and articles contributed by the community showcasing generative AI on the Jetson platform.
      </p>
      
      <div class="mt-10 flex flex-wrap justify-center gap-4">
        <a href="https://discord.gg/nvidia-jetson" target="_blank" rel="noopener" class="px-6 py-3 bg-nvidia-green text-nvidia-black font-bold rounded-lg hover:bg-nvidia-green/90 transition-all">
          Join Discord
        </a>
        <a href="https://github.com/dusty-nv/jetson-containers" target="_blank" rel="noopener" class="px-6 py-3 bg-white/10 backdrop-blur-sm text-white font-semibold rounded-lg hover:bg-white/20 transition-all border border-white/10">
          Contribute on GitHub
        </a>
      </div>
    </div>
  </section>

  <!-- Projects Grid -->
  <section class="py-20 bg-nvidia-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
        {allProjects.map((project) => {
          const colors = sourceColors[project.data.source] || sourceColors['Other'];
          return (
            <a href={project.data.link} target="_blank" rel="noopener" class="group bg-nvidia-gray-50 rounded-xl overflow-hidden border border-nvidia-gray-200 hover:border-nvidia-green/50 hover:shadow-lg transition-all duration-300">
              {/* Media */}
              <div class="relative aspect-video bg-nvidia-gray-100 overflow-hidden">
                {project.data.video ? (
                  <iframe 
                    src={project.data.video}
                    class="w-full h-full"
                    frameborder="0"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                    allowfullscreen
                  ></iframe>
                ) : project.data.image ? (
                  <img 
                    src={project.data.image} 
                    alt={project.data.title}
                    class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
                  />
                ) : (
                  <div class="w-full h-full flex items-center justify-center bg-gradient-to-br from-nvidia-gray-100 to-nvidia-gray-200">
                    <svg class="w-16 h-16 text-nvidia-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
                    </svg>
                  </div>
                )}
                
                {/* Source Badge */}
                <span class={`absolute top-3 left-3 px-2 py-1 text-xs font-bold rounded ${colors.bg} ${colors.text}`}>
                  {project.data.source}
                </span>
              </div>
              
              {/* Content */}
              <div class="p-5">
                <div class="flex items-center justify-between mb-2">
                  <span class="text-sm text-nvidia-gray-500">{project.data.author}</span>
                  <span class="text-sm text-nvidia-gray-400">
                    {new Date(project.data.date).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}
                  </span>
                </div>
                
                <h3 class="text-lg font-bold text-nvidia-black mb-2 group-hover:text-nvidia-green transition-colors line-clamp-2">
                  {project.data.title}
                </h3>
                
                <p class="text-nvidia-gray-600 text-sm line-clamp-3">
                  {project.data.description}
                </p>
                
                {project.data.tags && (
                  <div class="flex flex-wrap gap-1.5 mt-4">
                    {project.data.tags.slice(0, 3).map((tag: string) => (
                      <span class="px-2 py-0.5 bg-nvidia-gray-100 text-nvidia-gray-600 text-xs rounded-full">
                        {tag}
                      </span>
                    ))}
                  </div>
                )}
              </div>
            </a>
          );
        })}
      </div>
    </div>
  </section>

  <!-- Call to Action -->
  <section class="py-16 bg-nvidia-gray-50">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
      <h2 class="text-3xl font-bold text-nvidia-black mb-4">Share Your Project</h2>
      <p class="text-lg text-nvidia-gray-600 mb-8">
        Built something cool with Jetson and generative AI? We'd love to feature your project!
      </p>
      <a href="https://discord.gg/nvidia-jetson" target="_blank" rel="noopener" class="inline-flex items-center gap-2 px-8 py-4 bg-nvidia-green text-nvidia-black font-bold rounded-lg hover:bg-nvidia-green/90 transition-all">
        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
          <path d="M20.317 4.369a19.791 19.791 0 00-4.885-1.515.07.07 0 00-.073.035c-.211.375-.444.864-.608 1.249-1.844-.276-3.68-.276-5.486 0-.163-.393-.405-.874-.617-1.249a.07.07 0 00-.073-.035c-1.67.285-3.29.822-4.885 1.515a.064.064 0 00-.03.027C.533 9.045-.32 13.579.099 18.057a.07.07 0 00.028.048c2.052 1.507 4.042 2.422 5.992 3.029a.07.07 0 00.076-.027c.461-.63.873-1.295 1.226-1.994a.07.07 0 00-.038-.098c-.652-.247-1.27-.549-1.872-.892a.07.07 0 01-.007-.117c.126-.094.252-.192.372-.291a.07.07 0 01.071-.01c3.927 1.793 8.18 1.793 12.061 0a.07.07 0 01.072.009c.12.099.246.198.372.292a.07.07 0 01-.006.117 12.298 12.298 0 01-1.873.891.07.07 0 00-.038.099c.36.698.772 1.362 1.225 1.993a.07.07 0 00.076.028c1.95-.607 3.94-1.522 5.993-3.029a.07.07 0 00.028-.048c.5-5.177-.838-9.673-3.548-13.661a.061.061 0 00-.03-.028zM8.02 15.331c-1.183 0-2.156-1.085-2.156-2.419 0-1.333.955-2.418 2.156-2.418 1.21 0 2.175 1.095 2.156 2.418 0 1.334-.955 2.419-2.156 2.419zm7.974 0c-1.183 0-2.156-1.085-2.156-2.419 0-1.333.955-2.418 2.156-2.418 1.21 0 2.175 1.095 2.156 2.418 0 1.334-.946 2.419-2.156 2.419z"/>
        </svg>
        Share on Discord
      </a>
    </div>
  </section>
</Layout>

<style>
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  .line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>

